%! TEX root = 'main.tex'
\section{Introduction}
\label{sec:implant-introduction}

Critical infrastructure such as power grids comprises physical and cyber systems and assets that vital to national security. Their failure or incapacity would have a significant impact on people's daily life on a large scale. The automation of traditional manufacturing and industrial practices using modern information technology is considered the foundation of the fourth industrial revolution.  However, the informatization also brings security concerns. 

The industrial control system (ICS) interconnects and controls the physical production assets.  Compared to traditional IT infrastructures, the physical assets and the computer-based network's interconnection is a unique feature of ICS. It is achieved through an embedded system known as the programmable logic controller (PLC). In recent years, several worldwide incidents, such as the Stuxnet~\cite{langner2011stuxnet}, BlackEnergy~\cite{cherepanov2016blackenergy} targeted critical infrastructures operated by ICS. And the PLC is the prevalent device to control for sabotaging the physical infrastructure.


With the emergence of attacks, mitigation is also strengthened. ICS security has been traditionally handled using network security practices such as access control. A common strategy is to use an isolated network from the Internet. Through physical access control to the network interfaces or router policies, less software service is exposed to the public, reducing the potential attack surface, especially towards vulnerability-exploit-based attacks. However, the APT attack is even able to penetrate an air-gapped network~\cite{langner2011stuxnet}. The APT attack is essentially a Trojan attack, which gains unauthorized access to a computer network and remains undetected for an extended period. Its crucial feature is stealthiness. How to stay within the device is a common issue that sophisticated APT attacks should consider. In particular, firmware modification attacks aim to inject malware into the target PLC~\cite{garcia2017hey}.  It changes the binary hence the logic that runs in the device, and can also survive a system reboot. However, this attack subject to the firmware verification and update authentication method. It would be much harder for the attacker to implant the malware once the firmware update is encrypted and digitally signed. 

Another critical point for the ATP attack is choosing the trigger event. Usually, the PLC has a dedicated real-time microcontroller to control the physical world through its IO pins. But the microcontroller does not directly communicate with the host, the central control terminal (human-machine interface, HMI). Therefore, firmware modification attacks can perform a preset task individually, but it is difficult to react to PLC logic changes or coordinate a distributed attack with other controlled nodes, especially in an air-gapped network.

We propose an alternative approach to circumvent existing software mitigations, a parasitical hardware implant inside a PLC attaching to its circuit board and remotely controllable through GSM network.  With the recent emerging concept of supply chain attacks and real-world incidents~\cite{oxfordsolarwinds}, such a hardware attack appears more practical. The hardware implant can be pre-installed during the PLC device's assembly line or even during the shipment. We design it to be flexible because the PLC will load operating logic only after being deployed, and it is plausible that the ICS updates PLC's operating logic frequently. The hardware implant is specialized for the device's circuit board, the microcontroller, and other chips.  It controls the IO through the digital signal and bus-level protocol hijacking, independent of the PLC's firmware.

Memory bus and interconnect protocols such as SPI, I2C are all potential targets, but low-speed protocols are prevalent due to their simplicity. For instance, JTAG (Joint Test Action Group) is an industry-standard for verifying designs and testing integrated circuits (IC) after manufacture. 	On ARM microcontrollers, extensive hardware features are also provided through this interface for system-level debugging and tracing. Components used for debugging include reading and modifying register values of processors and peripherals, reading/writing memory. We leverage this interface for IO controlling purposes, and also we can download the PLC's firmware and operating logic for further analysis. Furthermore, with the ability to communicate through a GSM network, it is practical to control multiple nodes and organize a distributed attack simultaneously.


\textbf{Contributions.} To summarize, we make the following contributions in this paper:
\begin{itemize}[leftmargin=*]
	\item We present a novel attack class on industrial control systems: a parasitical hardware implant, which is completely invisible to the ICS control system.
	\item We disassembled and reverse engineered the circuit boards of a widely deployed Allen Bradley 1769-L18ER-BBIB CompactLogix 5370 PLC. 
	\item We develop a prototype implementation of \name, which is a small size device installed inside the Allen Bradley PLC. We tested a synchronized attack with multiple controlled nodes. 
	\item We write a JTAG driver that runs bare-metally on a microcontroller with minimal resource usage.
	\item We evaluate our attack against existed software mitigations in a test environment.

\end{itemize}


\textbf{Roadmap}
The rest of this paper is organized as the following. In~\autoref{sec:implant-background}, we provide the necessary background on programmable logic controllers and JTAG protocol. ~\autoref{sec:implant-overview} describes the objectives, adversary model and scope, challenges, and architecture of \name. ~\autoref{sec:implant-relatedwork} provides a review of related work in the area of embedded system attacks. ~\autoref{sec:implant-design} describes how we reverse-engineered the Allen Bradley PLC and prototyped \name with evaluation (~\autoref{sec:implant-evaluation}).  Finally~\autoref{sec:implant-conclusions} concludes the paper.
